!function(a){"function"==typeof define&&define.amd?define(["view","util","events"],a):a(View,window.util,window.EventEmitter,window.View)}(function(a,b,c){function d(a){if("string"==typeof a){if(n=document.querySelector(a),!n)return!1;j(n,"stage")}}function e(a,b){return a.stage?!1:(n.appendChild(a),b.duration&&(a.style.transitionDuration=b.duration+"ms",a.style.webkitTransitionDuration=b.duration+"ms",a.style.mozTransitionDuration=b.duration+"ms"),b.timingFunction&&(a.style.transitionDuration=b.timingFunction,a.style.webkitTransitionDuration=b.timingFunction,a.style.mozTransitionDuration=b.timingFunction),a.stage=m,a.stageOptions=b,!0)}function f(a,b,c,d){var e=b+"-out";c?(l(a,e)||j(a,e),j(a,"staged"),setTimeout(function(){k(a,e),d&&d()},15)):(j(a,e),setTimeout(function(){k(a,"staged"),d&&d()},a.stageOptions.duration||500))}function g(a){q?q.stageOptions&&q.stageOptions.animation?f(q,q.stageOptions.animation,!1,a):(k(q.base,"staged"),a&&a()):a&&a()}function h(a,b){p=!0;Date.now();g(function(){a.stageOptions&&a.stageOptions.animation?f(a,a.stageOptions.animation,!0,function(){q=a,p=!1,b&&b()}):(j(a,"staged"),q=a,p=!1,b&&b())})}function i(a){function b(){o.length&&o.pop()()}p||o.length?o.push(h.bind(m,a,b)):h(a,b)}function j(a,b){a.classList.contains(b)||a.classList.add(b)}function k(a,b){a.classList.remove(b)}function l(a,b){return a.classList.contains(b)}var m=new c,n=null,o=[],p=!1,q=null,r=!1;return b.extend(m,{init:function(a){return a.container?(d(a.container),void(r=!0)):!1},show:function(a,b){if(!r)return!1;if(!a)return!1;var c;return a instanceof HTMLElement||a instanceof Element?c=a:a.hasOwnProperty("base")?c=a.base:a.hasOwnProperty("0")&&(c=a[0]),b=b||a.stageOptions||{animation:!1},c?(c.stage||e(c,b),void i(c)):!1},hide:function(a,b){return r?(a instanceof b&&(b=a,a=null),a=a||!1,b&&b.base?q!==b.base?!1:void g(a):!1):!1}}),m});